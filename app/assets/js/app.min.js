const QUESTIONS_PER_ROUND=6,RE_ASK_CARD_AFTER_CARD_AMOUNT_MIN=4,RE_ASK_CARD_AFTER_CARD_AMOUNT_MAX=6,CORRECT_CARD_CONTINUE_DELAY_MS=250,SUPPORTED_LANGUAGES={de:"Duits",el:"Grieks",en:"Engels",es:"Spaans",fr:"Frans",fy:"Fries",la:"Latijn",nl:"Nederlands"};function quizletOpenSetFromUrl(e,t="learn"){const i=quizlet.sets.setIdFromUrl(e);isSet(i)&&9==i.length?(quizlet.storage.set("setting-mode","write"==t?"write":"learn"),window.location.href=`learn/?id=${i}&mode=${t}`):alert("De link die je hebt ingevuld is ongeldig.")}function quizletOpenSet(e){quizlet.storage.set("setId",e);const t=quizlet.storage.get("info"),i=quizlet.storage.get("cards");if(isSet(t)&&isSet(i)&&i!=[])return quizletStart(),!0;quizlet.api.request("set/info",{set_id:e}).then((e=>{$("#quizlet-scene-mc #quizlet-mc-answers");let t={};$.each(e.cards,(function(e,i){i.state=0,t[i.id]=i})),quizlet.storage.set("info",e.info),quizlet.storage.set("cards",t),quizletStart()})).catch((e=>{alert("Er is iets misgegegaan waardoor de Quizlet niet kon worden geladen.")}))}function quizletStart(){quizletUpdateScene(),quizletRefreshProgressBar(),quizletApplySetInfoToInterface(),quizletRefreshSettingsInterface()}function quizletApplySetInfoToInterface(){const e=quizlet.storage.get("info"),t=quizlet.storage.get("cards"),i=t[Object.keys(t)[0]];$.each(i.cardSides,(function(e,t){const i=t.media[0];if(!isSet(i))return!0;const n=i.languageCode,r=SUPPORTED_LANGUAGES[n];if(!isSet(r))return!0;const s=quizlet.storage.get("setting-answerWith")||"definition";0==e?($("#quizlet-settings-answer-with-word").text(r),$(`.quizlet-${"word"==s?"answer":"question"}-heading`).text(r)):($("#quizlet-settings-answer-with-definition").text(r),$(`.quizlet-${"definition"==s?"answer":"question"}-heading`).text(r))})),$("#quizlet-set-title").text(e.title),$("#quizlet-set-creator").html(`<a target="_blank" rel="noopener noreferrer" href="https://quizlet.com/${e.creator.url}">${e.creator.name}</a>`)}function quizletOpenSettings(){const e=$("#quizlet-btn-settings"),t=$("#quizlet-settings");e.addClass("focus").find("i").addClass("fa-rotate-180"),t.addClass("show")}function quizletCloseSettings(){const e=$("#quizlet-btn-settings"),t=$("#quizlet-settings");e.removeClass("focus").find("i").removeClass("fa-rotate-180"),t.removeClass("show")}function quizletRefreshSettingsInterface(){$("#quizlet-settings").find(".quizlet-settings-group").each((function(e,t){const i=$(t),n=i.attr("data-setting"),r=quizlet.storage.get(`setting-${n}`),s=i.find(`[data-value="${r}"]`);s.siblings().removeClass("btn-primary").addClass("btn-secondary"),s.addClass("btn-primary").removeClass("btn-secondary")}))}function quizletShowScene(e){$(".quizlet-scene").hide(),$(`#quizlet-scene-${e}`).show()}function quizletUpdateScene(){const e=quizletUpdateQuestion();if(0==e&&quizletCelebrate(),isSet(e.card)){if($("#quizlet-writable-input").val("").show(),$("#quizlet-writable-answer").hide(),$("#quizlet-writable-user-answer").removeClass("text-success text-danger"),$("#quizlet-writable-corr-answer").text(""),$("#quizlet-writable-mark-answer-correct").hide(),$("#quizlet-btn-continue").removeClass("show"),$("#quizlet-mc-answers").empty(),"multipleChoice"==e.questionType){if(!quizletUpdateAnswers(e.card))return quizletUpdateScene()}else if(!quizletUpdateInput(e.card))return quizletUpdateScene();return!0}}function quizletCelebrate(){quizletRefreshProgressBar(1e3),quizletShowScene("celebration"),$("#quizlet-btn-continue").hide()}function quizletRedo(){let e=quizlet.storage.get("cards");return $.each(e,(function(e,t){t.state=0})),quizlet.storage.set("cards",e),quizletStart(),!0}function quizletGetHighestPriorityCard(e=!1){const t=quizletGetCardsByState(e);let i=[];if(t[2].length>0)i=t[2];else if(t[1].length>0)i=t[1];else if(t[0].length>0)i=t[0];else{if(e)return!1;const t=quizletGetCardsByState(!0);if(t[0].length>0||t[1].length>0||t[2].length>0)return quizletGetHighestPriorityCard(!0)}const n=randomItem(i);return!!isSet(n)&&n}function quizletUpdateQuestion(){const e=quizletGetHighestPriorityCard();if(0==e)return!1;const t=1-("word"==(quizlet.storage.get("setting-answerWith")||"definition")?0:1);$("#quizlet-mc-question").text(e?.cardSides[t]?.media[0]?.plainText);const i=parseInt(quizlet.storage.get("cardIndex"))||0;quizlet.storage.set("cardIndex",i+1),quizlet.storage.set("cardId",e.id);let n;return n="write"==(quizlet.storage.get("setting-mode")||"learn")||2==e.state?"write":"multipleChoice",{card:e,questionType:n}}function quizletUpdateAnswers(e){quizletShowScene("mc");let t=quizlet.storage.get("cards");delete t[e.id];const i=$("#quizlet-mc-answers");quizletAddAnswer(e,!0);for(let e=0;e<3;e++){const e=randomProperty(t);quizletAddAnswer(e,!1),delete t[e.id]}return i.shuffleChildren(),$.each(i.children(),(function(e,t){const i=$(t),n=i.index()+1;i.find(".card-icon").text(n),i.attr("title",`Sneltoets: ${n}`)})),!0}function quizletConfirmWritable(e,t=!0){let i=quizlet.storage.get("cards");const n=quizlet.storage.get("cardId"),r=$("#quizlet-writable-input").attr("data-answer"),s=quizletSmartCompareWritableAnswer(e,r),a=parseInt(quizlet.storage.get("cardIndex"))||0;return 1==s?(i[n].state=3,quizletRefreshProgressBar(1),t&&setTimeout((()=>{quizletUpdateScene()}),250)):"semi"==s?(i[n].state=3,quizletRefreshProgressBar(1),$("#quizlet-btn-continue").addClass("show")):(i[n].minCardIndexForReAsk=a+random(4,6),$("#quizlet-btn-continue").addClass("show")),quizlet.storage.set("cards",i),$("#quizlet-writable-input").hide(),$("#quizlet-writable-answer").show().find("#quizlet-writable-user-answer").text(e).removeClass("text-success text-danger").addClass(s?"text-success":"text-danger"),$("#quizlet-writable-corr-answer").text(""),!0!==s&&($("#quizlet-writable-answer").find("#quizlet-writable-corr-answer").text(r),!1===s&&$("#quizlet-writable-mark-answer-correct").show()),s}function quizletRefreshProgressBar(e=0){const t=Object.keys(quizlet.storage.get("cards")).length,i=(quizletGetCardsByState()[3].length+e)/t*100;$("#quizlet-progress-bar-total .quizlet-progress-bar-inner").css("width",i+"%")}function quizletSmartCompareWritableAnswer(e,t){const i=/( \||\| |\|| ,|, |,| \/|\/ |\/ |\/|\:|\: |\:)/gm;return(e=e.trim().toLowerCase().replaceAll(i,"|"))==(t=t.trim().toLowerCase().replaceAll(i,"|"))}function quizletMarkWritableAnswerCorrect(){return quizletConfirmWritable($("#quizlet-writable-input").attr("data-answer"),!1),quizletUpdateScene(),!0}function quizletUpdateInput(e){quizletShowScene("writable");const t=$("#quizlet-writable-input"),i=$("#quizlet-writable-question"),n="word"==(quizlet.storage.get("setting-answerWith")||"definition")?0:1,r=1-n;return i.text(e.cardSides[r]?.media[0]?.plainText),t.attr("data-answer",e.cardSides[n]?.media[0]?.plainText),t.focus(),!0}function quizletConfirmAnswer(e,t=!0){let i=quizlet.storage.get("cards");const n=$("#quizlet-mc-answers"),r=(i[e],$(`.quizlet-mc-card[data-id="${e}"]`)),s="true"==r.attr("data-correct"),a=parseInt(quizlet.storage.get("cardIndex"))||0;return r.addClass("quizlet-mc-card-active"),n.find('[data-correct="true"]').addClass("quizlet-mc-card-active"),s?(i[e].state=2,i[e].minCardIndexForReAsk=a+random(4,6),t&&setTimeout((()=>{quizletUpdateScene()}),250)):(i[e].state=1,i[e].minCardIndexForReAsk=a+random(4,6),$("#quizlet-btn-continue").addClass("show")),quizlet.storage.set("cards",i),!0}function quizletAddAnswer(e,t=!1){const i=$("#quizlet-mc-answers"),n=getTemplate("quizlet-mc-card"),r="word"==(quizlet.storage.get("setting-answerWith")||"definition")?0:1;n.attr({"data-id":e.id,"data-correct":t,onclick:`quizletConfirmAnswer('${e.id}')`}),n.find(".card-body").text(e?.cardSides[r]?.media[0]?.plainText),n.appendTo(i)}function quizletGetCardsByState(e=!1){const t=quizlet.storage.get("cards"),i=parseInt(quizlet.storage.get("cardIndex"))||0;let n={0:[],1:[],2:[],3:[]};return $.each(t,(function(t,r){return isSet(r.state)||(r.state=0),!isSet(n[r.state])||(!!(0==e&&isSet(r.minCardIndexForReAsk)&&i<r.minCardIndexForReAsk)||void n[r.state].push(r))})),0==e&&0==n[0].length&&0==n[1].length&&0==n[2].length?quizletGetCardsByState(!0):n}$(document).on("click","#quizlet-btn-settings",(function(){$(this).hasClass("focus")?quizletCloseSettings():quizletOpenSettings()})),$(document).on("click",(function(e){const t=$(e.target);t.closest("#quizlet-settings").length||t.closest("#quizlet-btn-settings").length||quizletCloseSettings()})),$(document).on("click",".quizlet-btn-setting:not(.btn-primary)",(function(){const e=$(this),t=e.attr("data-value"),i=e.closest(".quizlet-settings-group").attr("data-setting");isSet(t)&&isSet(i)&&(quizlet.storage.set(`setting-${i}`,t),quizletRefreshSettingsInterface(),quizletStart())})),$(document).on("keypress",(function(e){const t=e.key.toLowerCase();if(isSet(t))if("enter"==t)$("#quizlet-btn-continue.show").trigger("click");else if(!1===isNaN(t)&&" "!=t){$("#quizlet-mc-answers").find(`.quizlet-mc-card:nth-child(${t})`).trigger("click")}else{if(" "!=t)return;$('#quizlet-writable-mark-answer-correct:not([style*="none"])').trigger("click")}}));